function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};var i,n,s=require("atom-package-deps").install,r=e(require("path")),o=require("url").parse,a=require("assert"),l=a,c=e(a),u=e(require("react-dom")),h=require("react"),d=(i={},n=h,Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(i,e,{enumerable:!0,get:function(){return n[e]}})})),i),p=e(h),f=h.useEffect,g=h.useState,m=require("electron").shell,b=require("atom"),k=b.CompositeDisposable,w=b.Disposable,v=b.Emitter,y=b.Range;let x=null;const S={error:3,warning:2,info:1},E={error:"Error",warning:"Warning",info:"Info"},P=["center","bottom"];function _(e){return e.location.position}function C(e){return e.location.file}function T(e){return atom.project.relativizePath(C(e)||"")[1]}function z(){let e=atom.workspace.getCenter().getActivePaneItem();const t=null!==e&&atom.workspace.isTextEditor(e);return!t&&e&&x&&e.getURI&&"atom://linter-ui-default"===e.getURI()&&(!x.isAlive||x.isAlive())?e=x:x=e,t?e:null}function R(e,t,i=null){const n=[];return e.forEach((function(e){e&&e.location&&(null!==t&&C(e)!==t||i&&e.severity!==i||n.push(e))})),n}function $(e,t,i){const n=[],s="Point"===i.constructor.name?new y(i,i):y.fromObject(i);return e.forEach((function(e){const i=C(e),r=_(e);i&&r&&i===t&&"function"==typeof r.intersectsWith&&r.intersectsWith(s)&&n.push(e)})),n}function A(e,t){const i={searchAllPanes:!0};t&&(i.initialLine=t.row,i.initialColumn=t.column),atom.workspace.open(e,i)}function I(e,t=!1){let i,n;if(t){if(!e.reference||!e.reference.file)return void console.warn("[Linter-UI-Default] Message does not have a valid reference. Ignoring");i=e.reference.file,n=e.reference.position}else{const t=_(e);i=C(e),t&&(n=t.start)}i&&A(i,n)}function L(e){2===e.version&&e.url&&m.openExternal(e.url)}function M(e,t){const i={};return e.forEach((function(e){i[e.column]=e.type})),t.slice().sort((function(e,t){if(i.severity){const n="asc"===i.severity?1:-1,s=S[e.severity],r=S[t.severity];if(s!==r)return n*(s>r?1:-1)}if(i.linterName){const n="asc"===i.linterName?1:-1,s=e.severity.localeCompare(t.severity);if(0!==s)return n*s}if(i.file){const n="asc"===i.file?1:-1,s=T(e),r=s.length,o=T(t),a=o.length;if(r!==a)return n*(r>a?1:-1);if(s!==o)return n*s.localeCompare(o)}if(i.line){const n="asc"===i.line?1:-1,s=_(e),r=_(t);if(s&&!r)return 1;if(r&&!s)return-1;if(s&&r){if(s.start.row!==r.start.row)return n*(s.start.row>r.start.row?1:-1);if(s.start.column!==r.start.column)return n*(s.start.column>r.start.column?1:-1)}}return 0}))}function D(e){return e.sort((function(e,t){return void 0===e.priority||void 0===t.priority?0:t.priority-e.priority}))}function B(e,t){if("apply"in t)return t.apply(),!0;const i=t.position,n=t.replaceWith;if("currentText"in t){const n=t.currentText,s=e.getTextInBufferRange(i);if(n!==s)return console.warn("[linter-ui-default] Not applying fix because text did not match the expected one","expected",n,"but got",s),!1}return e.setTextInBufferRange(i,n),!0}const O=atom.config.get("linter-ui-default.largeFileLineCount"),N=atom.config.get("linter-ui-default.longLineLength");class j{constructor(){let e;this.emitter=new v,this.messages=[],this.filteredMessages=[],this.subscriptions=new k,this.subscriptions.add(atom.config.observe("linter-ui-default.panelRepresents",(e=>{const t=void 0!==this.panelRepresents;this.panelRepresents=e,t&&this.update()}))),this.subscriptions.add(atom.workspace.getCenter().observeActivePaneItem((()=>{e&&(e.dispose(),e=null);const t=z();if(t){"Entire Project"!==this.panelRepresents&&this.update();let i=-1;e=t.onDidChangeCursorPosition((({newBufferPosition:e})=>{i!==e.row&&"Current Line"===this.panelRepresents&&(i=e.row,this.update())}))}("Entire Project"!==this.panelRepresents||t)&&this.update()}))),this.subscriptions.add(new w((function(){e&&e.dispose()})))}getFilteredMessages(){let e=[];if("Entire Project"===this.panelRepresents)e=this.messages;else if("Current File"===this.panelRepresents){const t=z();if(!t)return[];e=R(this.messages,t.getPath())}else if("Current Line"===this.panelRepresents){const t=z();if(!t)return[];const i=t.getCursors()[0].getBufferRow();e=$(this.messages,t.getPath(),y.fromObject([[i,0],[i,1/0]]))}return e}update(e=null){Array.isArray(e)&&(this.messages=e),this.filteredMessages=this.getFilteredMessages(),this.emitter.emit("observe-messages",this.filteredMessages)}onDidChangeMessages(e){return this.emitter.on("observe-messages",e)}dispose(){this.subscriptions.dispose()}}var F,q,H,U=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),W=(H=d)&&H.__esModule?H:{default:H},Z={};Object.defineProperty(Z,"__esModule",{value:!0});var V=void 0;Z.ARROW=V;var K=function(e){(0,G.default)(Array.isArray(e.rows),"rows must be an Array"),(0,G.default)(Array.isArray(e.columns),"columns must be an Array"),(0,G.default)(!e.sortInfo||Array.isArray(e.sortInfo),"sortInfo must be an Array"),(0,G.default)("function"==typeof e.sort,"sort must be a function"),(0,G.default)("function"==typeof e.rowKey,"rowKey must be a function"),(0,G.default)("function"==typeof e.renderHeaderColumn,"renderHeaderColumn must be a function"),(0,G.default)("function"==typeof e.renderBodyColumn,"renderBodyColumn must be a function")};Z.validateProps=K;var G=function(e){return e&&e.__esModule?e:{default:e}}(l);V={UP:"↑",DOWN:"↓",BOTH:"⇅"},Z.ARROW=V;function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var J=e((q=F=function(e){function t(){var e,i,n;X(this,t);for(var s=arguments.length,r=Array(s),o=0;o<s;o++)r[o]=arguments[o];return i=n=Y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.state={sort:null},Y(n,i)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,W.default.Component),U(t,[{key:"getSort",value:function(){return this.state.sort||this.props.initialSort||[]}},{key:"findSortItemByKey",value:function(e){var t=this.getSort();if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)if(t[i].column===e)return i;return-1}},{key:"generateSortCallback",value:function(e){var t=this;return function(i){var n=t.getSort(),s=i.shiftKey,r=t.findSortItemByKey(e);if(r<0){var o={column:e,type:"asc"};(n=s?n:[]).push(o)}else{var a=n[r];a.type="asc"===a.type?"desc":null,s?a.type||n.splice(r,1):n=a.type?[a]:[]}t.setState({sort:n})}}},{key:"renderHeaderIcon",value:function(e){var t=this.getSort(),i=t?this.findSortItemByKey(e):-1,n=Z.ARROW.BOTH;return t&&-1!==i&&(n="asc"===t[i].type?Z.ARROW.UP:Z.ARROW.DOWN),W.default.createElement("span",{className:"sort-icon"},n)}},{key:"render",value:function(){var e=this,i=this.props,n=i.rows,s=i.columns,r=i.className,o=void 0===r?"":r,a=i.rowKey,l=i.sort,c=i.renderHeaderColumn,u=void 0===c?t.defaultHeaderRenderer:c,h=i.renderBodyColumn,d=void 0===h?t.defaultBodyRenderer:h;(0,Z.validateProps)(this.props);var p=n,f=this.getSort();return f.length&&(p=l(f,p)),W.default.createElement("table",{className:"sb-table "+o,style:this.props.style},W.default.createElement("thead",null,W.default.createElement("tr",null,s.map((function(t){return W.default.createElement("th",{key:t.key,className:t.sortable&&"sortable",onClick:t.sortable&&e.generateSortCallback(t.key)},u(t)," ",t.sortable&&e.renderHeaderIcon(t.key))})))),W.default.createElement("tbody",null,p.map((function(e){var t=a(e);return W.default.createElement("tr",{key:t},s.map((function(i){var n=i.onClick,s=n&&function(t){n(t,e)};return W.default.createElement("td",{onClick:s,key:t+"."+i.key},d(e,i.key))})))}))))}}],[{key:"defaultHeaderRenderer",value:function(e){if("string"!=typeof e)throw new Error("Non-string header array fed to sb-react-table without renderHeaderColumn prop");return e}},{key:"defaultBodyRenderer",value:function(e,t){var i=e[t];if("string"!=typeof i)throw new Error("Non-predictable rows fed to sb-react-table without renderBodyColumn prop");return i}}]),t}(),F.defaultProps={style:null,className:null,initialSort:null},q));function Q(e){const[t,i]=g({messages:e.delegate.filteredMessages});function n(e,t){"A"!==e.target.tagName&&(("darwin"===process.platform?e.metaKey:e.ctrlKey)?e.shiftKey?L(t):I(t,!0):I(t))}f((()=>{e.delegate.onDidChangeMessages((e=>{i({messages:e})}))}),[]);const s=[{key:"severity",label:"Severity",sortable:!0},{key:"linterName",label:"Provider",sortable:!0},{key:"excerpt",label:"Description",onClick:n},{key:"line",label:"Line",sortable:!0,onClick:n}];return"Entire Project"===e.delegate.panelRepresents&&s.push({key:"file",label:"File",sortable:!0,onClick:n}),p.createElement("div",{id:"linter-panel",tabIndex:-1,style:{overflowY:"scroll",height:"100%"}},p.createElement(J,{rows:t.messages,columns:s,initialSort:[{column:"severity",type:"desc"},{column:"file",type:"asc"},{column:"line",type:"asc"}],sort:M,rowKey:e=>e.key,renderHeaderColumn:e=>e.label,renderBodyColumn:ee,style:{width:"100%"},className:"linter"}))}function ee(e,t){const i=_(e);switch(t){case"file":return T(e);case"line":return i?`${i.start.row+1}:${i.start.column+1}`:"";case"excerpt":return e.excerpt;case"severity":return E[e.severity];default:return e[t]}}function te(e){const t=atom.workspace.paneContainerForItem(e);return t&&"object"==typeof t.state&&"number"==typeof t.state.size&&"function"==typeof t.render?t:null}class ie{constructor(e){this.element=document.createElement("div"),this.subscriptions=new k,this.panelHeight=100,this.alwaysTakeMinimumSpace=!0,this.subscriptions.add(atom.config.observe("linter-ui-default.panelHeight",(e=>{const t="number"==typeof this.panelHeight;this.panelHeight=e,t&&this.doPanelResize(!0)}))),this.subscriptions.add(atom.config.observe("linter-ui-default.alwaysTakeMinimumSpace",(e=>{this.alwaysTakeMinimumSpace=e}))),this.doPanelResize(),u.render(p.createElement(Q,{delegate:e}),this.element)}doPanelResize(e=!1){const t=te(this);if(null===t)return;let i=null;const n=atom.views.getView(t);if(n&&this.alwaysTakeMinimumSpace){const e=n.querySelector(".list-inline.tab-bar.inset-panel"),t=e?e.getClientRects()[0]:null,s=this.element.querySelector("table"),r=s?s.getClientRects()[0]:null;t&&r&&(i=t.height+r.height+1)}let s=null;const r=null===i||e?this.panelHeight:Math.min(i,this.panelHeight);null===this.lastSetPaneHeight||t.state.size===this.lastSetPaneHeight||e||(s=t.state.size),this.lastSetPaneHeight=r,t.state.size=r,t.render(t.state),null!==s&&atom.config.set("linter-ui-default.panelHeight",s)}getURI(){return"atom://linter-ui-default"}getTitle(){return"Linter"}getDefaultLocation(){return"bottom"}getAllowedLocations(){return P}getPreferredHeight(){return atom.config.get("linter-ui-default.panelHeight")}dispose(){var e;this.subscriptions.dispose();const t=te(this);null===t||this.alwaysTakeMinimumSpace||t.state.size===this.panelHeight||(atom.config.set("linter-ui-default.panelHeight",t.state.size),null===(e=t.paneForItem(this))||void 0===e||e.destroyItem(this,!0))}}class ne{constructor(){this.panel=null,this.element=document.createElement("div"),this.delegate=new j,this.messages=[],this.deactivating=!1,this.subscriptions=new k,this.showPanelConfig=!0,this.hidePanelWhenEmpty=!0,this.showPanelStateMessages=!1,this.subscriptions.add(this.delegate),this.subscriptions.add(atom.config.observe("linter-ui-default.hidePanelWhenEmpty",(e=>{this.hidePanelWhenEmpty=e,this.refresh()}))),this.subscriptions.add(atom.workspace.onDidDestroyPane((({pane:e})=>{(null===this.panel||e.getItems().includes(this.panel))&&!this.deactivating&&(this.panel=null,atom.config.set("linter-ui-default.showPanel",!1))}))),this.subscriptions.add(atom.workspace.onDidDestroyPaneItem((({item:e})=>{e instanceof ie&&!this.deactivating&&(this.panel=null,atom.config.set("linter-ui-default.showPanel",!1))}))),this.subscriptions.add(atom.config.observe("linter-ui-default.showPanel",(e=>{this.showPanelConfig=e,this.refresh()}))),this.subscriptions.add(atom.workspace.getCenter().observeActivePaneItem((()=>{this.showPanelStateMessages=!!this.delegate.filteredMessages.length,this.refresh()}))),this.activationTimer=window.requestIdleCallback((()=>{let e=!0;const t=atom.workspace.getBottomDock();this.subscriptions.add(t.onDidChangeActivePaneItem((t=>{if(!this.panel||"bottom"!==this.getPanelLocation())return;if(e)return void(e=!1);t===this.panel!==this.showPanelConfig&&atom.config.set("linter-ui-default.showPanel",!this.showPanelConfig)}))),this.subscriptions.add(t.onDidChangeVisible((e=>{if(!this.panel||"bottom"!==this.getPanelLocation())return;if(!e&&this.showPanelConfig&&this.hidePanelWhenEmpty&&!this.showPanelStateMessages)return;if(t.getActivePaneItem()!==this.panel)return;e!==this.showPanelConfig&&atom.config.set("linter-ui-default.showPanel",!this.showPanelConfig)}))),this.activate()}))}getPanelLocation(){if(!this.panel)return null;const e=atom.workspace.paneContainerForItem(this.panel);return e&&e.location||null}async activate(){this.panel||(this.panel=new ie(this.delegate),await atom.workspace.open(this.panel,{activatePane:!1,activateItem:!1,searchAllPanes:!0}),this.update(),this.refresh())}update(e=null){e&&(this.messages=e),this.delegate.update(this.messages),this.showPanelStateMessages=!!this.delegate.filteredMessages.length,this.refresh()}async refresh(){var e;const t=this.panel;if(null===t)return void(this.showPanelConfig&&await this.activate());const i=atom.workspace.paneContainerForItem(t);if(!i||"bottom"!==i.location)return;const n=i.getActivePaneItem()===t,s=this.showPanelConfig,r=!this.hidePanelWhenEmpty||this.showPanelStateMessages;s&&r?(n||null===(e=i.paneForItem(t))||void 0===e||e.activateItem(t),i.show(),t.doPanelResize()):n&&i.hide()}dispose(){this.deactivating=!0,this.panel&&this.panel.dispose(),this.subscriptions.dispose(),window.cancelIdleCallback(this.activationTimer)}}class se{constructor(){this.messages=[],this.subscriptions=new k,this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-ui-default:next":()=>this.move(!0,!0),"linter-ui-default:previous":()=>this.move(!1,!0),"linter-ui-default:next-error":()=>this.move(!0,!0,"error"),"linter-ui-default:previous-error":()=>this.move(!1,!0,"error"),"linter-ui-default:next-warning":()=>this.move(!0,!0,"warning"),"linter-ui-default:previous-warning":()=>this.move(!1,!0,"warning"),"linter-ui-default:next-info":()=>this.move(!0,!0,"info"),"linter-ui-default:previous-info":()=>this.move(!1,!0,"info"),"linter-ui-default:next-in-current-file":()=>this.move(!0,!1),"linter-ui-default:previous-in-current-file":()=>this.move(!1,!1),"linter-ui-default:next-error-in-current-file":()=>this.move(!0,!1,"error"),"linter-ui-default:previous-error-in-current-file":()=>this.move(!1,!1,"error"),"linter-ui-default:next-warning-in-current-file":()=>this.move(!0,!1,"warning"),"linter-ui-default:previous-warning-in-current-file":()=>this.move(!1,!1,"warning"),"linter-ui-default:next-info-in-current-file":()=>this.move(!0,!1,"info"),"linter-ui-default:previous-info-in-current-file":()=>this.move(!1,!1,"info"),"linter-ui-default:toggle-panel":()=>this.togglePanel(),"linter-ui-default:expand-tooltip":function(){},"linter-ui-default:collapse-tooltip":function(){}})),this.subscriptions.add(atom.commands.add("atom-text-editor:not([mini])",{"linter-ui-default:apply-all-solutions":()=>this.applyAllSolutions()})),this.subscriptions.add(atom.commands.add("#linter-panel",{"core:copy":()=>{const e=document.getSelection();e&&atom.clipboard.write(e.toString())}}))}togglePanel(){atom.config.set("linter-ui-default.showPanel",!atom.config.get("linter-ui-default.showPanel"))}applyAllSolutions(){const e=z();c(e,"textEditor was null on a command supposed to run on text-editors only");M([{column:"line",type:"desc"}],R(this.messages,e.getPath())).forEach((function(t){2===t.version&&t.solutions&&t.solutions.length&&B(e,D(t.solutions)[0])}))}move(e,t,i=null){const n=z(),s=n&&n.getPath()||NaN,r=M([{column:"file",type:"asc"},{column:"line",type:"asc"}],R(this.messages,t?null:s,i)),o=e?-1:1;if(!n){const t=e?r[0]:r[r.length-1];return void(t&&I(t))}const a=n.getCursorBufferPosition();e||r.reverse();let l=null,c=!1;for(let e=0,t=r.length;e<t;e++){const t=r[e],i=C(t),n=_(t);if(c||i!==s||(c=!0),i&&n){if(c&&i!==s){l=t;break}if(i===s&&a.compare(n.start)===o){l=t;break}}}!l&&r.length&&(l=r[0]),l&&I(l)}update(e){this.messages=e}dispose(){this.subscriptions.dispose()}}function re(e){const t=document.createElement("a");return t.classList.add(`icon-${e}`),t.appendChild(document.createTextNode("")),t}class oe{constructor(){this.item=document.createElement("div"),this.itemErrors=re("stop"),this.itemWarnings=re("alert"),this.itemInfos=re("info"),this.emitter=new v,this.subscriptions=new k,this.item.appendChild(this.itemErrors),this.item.appendChild(this.itemWarnings),this.item.appendChild(this.itemInfos),this.item.classList.add("inline-block"),this.item.classList.add("linter-status-count"),this.subscriptions.add(this.emitter),this.subscriptions.add(atom.tooltips.add(this.itemErrors,{title:"Linter Errors"})),this.subscriptions.add(atom.tooltips.add(this.itemWarnings,{title:"Linter Warnings"})),this.subscriptions.add(atom.tooltips.add(this.itemInfos,{title:"Linter Infos"})),this.itemErrors.onclick=()=>this.emitter.emit("click","error"),this.itemWarnings.onclick=()=>this.emitter.emit("click","warning"),this.itemInfos.onclick=()=>this.emitter.emit("click","info"),this.update(0,0,0)}setVisibility(e,t){t?this.item.classList.remove(`hide-${e}`):this.item.classList.add(`hide-${e}`)}update(e,t,i){this.itemErrors.childNodes[0].textContent=String(e),this.itemWarnings.childNodes[0].textContent=String(t),this.itemInfos.childNodes[0].textContent=String(i),e?this.itemErrors.classList.add("text-error"):this.itemErrors.classList.remove("text-error"),t?this.itemWarnings.classList.add("text-warning"):this.itemWarnings.classList.remove("text-warning"),i?this.itemInfos.classList.add("text-info"):this.itemInfos.classList.remove("text-info")}onDidClick(e){return this.emitter.on("click",e)}dispose(){this.subscriptions.dispose()}}class ae{constructor(){this.element=new oe,this.messages=[],this.subscriptions=new k,this.subscriptions.add(this.element),this.subscriptions.add(atom.config.observe("linter-ui-default.statusBarRepresents",(e=>{const t=void 0!==this.statusBarRepresents;this.statusBarRepresents=e,t&&this.update()}))),this.subscriptions.add(atom.config.observe("linter-ui-default.statusBarClickBehavior",(e=>{const t=void 0!==this.statusBarClickBehavior;this.statusBarClickBehavior=e,t&&this.update()}))),this.subscriptions.add(atom.config.observe("linter-ui-default.showStatusBar",(e=>{this.element.setVisibility("config",e)}))),this.subscriptions.add(atom.workspace.getCenter().observeActivePaneItem((e=>{const t=atom.workspace.isTextEditor(e);this.element.setVisibility("pane",t),t&&"Current File"===this.statusBarRepresents&&this.update()}))),this.element.onDidClick((e=>{const t=atom.views.getView(atom.workspace);if("Toggle Panel"===this.statusBarClickBehavior)atom.commands.dispatch(t,"linter-ui-default:toggle-panel");else if("Toggle Status Bar Scope"===this.statusBarClickBehavior)atom.config.set("linter-ui-default.statusBarRepresents","Entire Project"===this.statusBarRepresents?"Current File":"Entire Project");else{const i="Current File"===this.statusBarRepresents?"-in-current-file":"";atom.commands.dispatch(t,`linter-ui-default:next-${e}${i}`)}}))}update(e=null){e?this.messages=e:e=this.messages;const t={error:0,warning:0,info:0},i=z(),n=i&&i.getPath()||NaN;e.forEach((e=>{"Entire Project"!==this.statusBarRepresents&&C(e)!==n||("error"===e.severity?t.error++:"warning"===e.severity?t.warning++:t.info++)})),this.element.update(t.error,t.warning,t.info)}attach(e){let t=null;this.subscriptions.add(atom.config.observe("linter-ui-default.statusBarPosition",(i=>{t&&t.destroy(),t=e[`add${i}Tile`]({item:this.element.item,priority:"Left"===i?0:1e3})}))),this.subscriptions.add(new w((function(){t&&t.destroy()})))}dispose(){this.subscriptions.dispose()}}class le{constructor(){this.executing=new Set,this.providerTitles=new Set,this.useBusySignal=!0,this.subscriptions=new k,this.subscriptions.add(atom.config.observe("linter-ui-default.useBusySignal",(e=>{this.useBusySignal=e})))}attach(e){this.provider=e.create(),this.update()}update(){const e=this.provider;if(!e)return;if(!this.useBusySignal)return;const t=new Map,i=new Set;for(const{filePath:e,linter:i}of this.executing){let n=t.get(e);n||t.set(e,n=[]),n.push(i.name)}for(const[n,s]of t){const t=n?` on ${atom.project.relativizePath(n)[1]}`:"";s.forEach((n=>{const s=`${n}${t}`;i.add(s),this.providerTitles.has(s)||(this.providerTitles.add(s),e.add(s))}))}this.providerTitles.forEach((t=>{i.has(t)||(e.remove(t),this.providerTitles.delete(t))})),t.clear()}getExecuting(e,t){for(const i of this.executing)if(i.linter===e&&i.filePath===t)return i;return null}didBeginLinting(e,t){this.getExecuting(e,t)||(this.executing.add({linter:e,filePath:t}),this.update())}didFinishLinting(e,t){const i=this.getExecuting(e,t);i&&(this.executing.delete(i),this.update())}dispose(){this.provider&&this.provider.clear(),this.providerTitles.clear(),this.executing.clear(),this.subscriptions.dispose()}}class ce{constructor(){this.messages=[],this.grammarScopes=["*"]}getIntentions({textEditor:e,bufferPosition:t}){let i=[];const n=R(this.messages,e.getPath());for(const s of n){if(!(s.solutions&&s.solutions.length))continue;const n=_(s);if(!(n&&n.containsPoint(t)))continue;let r=[];2===s.version&&s.solutions&&s.solutions.length&&(r=s.solutions);const o=s.linterName||"Linter";i=i.concat(r.map((t=>({priority:t.priority?t.priority+200:200,icon:"tools",title:t.title||`Fix ${o} issue`,selected:function(){B(e,t)}}))))}return i}update(e){this.messages=e}}var ue;ue=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var he,de={},pe="object"==typeof t&&t&&t.Object===Object&&t,fe="object"==typeof self&&self&&self.Object===Object&&self,ge=pe||fe||Function("return this")();he=function(){return de.Date.now()};var me,be,ke=me=(de=ge).Symbol,we=Object.prototype,ve=we.hasOwnProperty,ye=we.toString,xe=ke?ke.toStringTag:void 0;be=function(e){var t=ve.call(e,xe),i=e[xe];try{e[xe]=void 0;var n=!0}catch(e){}var s=ye.call(e);return n&&(t?e[xe]=i:delete e[xe]),s};var Se=Object.prototype.toString;var Ee=be,Pe=function(e){return Se.call(e)},_e=me?me.toStringTag:void 0;var Ce=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_e&&_e in Object(e)?Ee(e):Pe(e)},Te=function(e){return null!=e&&"object"==typeof e};var ze=ue,Re=function(e){return"symbol"==typeof e||Te(e)&&"[object Symbol]"==Ce(e)},$e=/^\s+|\s+$/g,Ae=/^[-+]0x[0-9a-f]+$/i,Ie=/^0b[01]+$/i,Le=/^0o[0-7]+$/i,Me=parseInt;var De=ue,Be=he,Oe=function(e){if("number"==typeof e)return e;if(Re(e))return NaN;if(ze(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ze(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace($e,"");var i=Ie.test(e);return i||Le.test(e)?Me(e.slice(2),i?2:8):Ae.test(e)?NaN:+e},Ne=Math.max,je=Math.min;var Fe=e((function(e,t,i){var n,s,r,o,a,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var i=n,r=s;return n=s=void 0,c=t,o=e.apply(r,i)}function f(e){return c=e,a=setTimeout(m,t),u?p(e):o}function g(e){var i=e-l;return void 0===l||i>=t||i<0||h&&e-c>=r}function m(){var e=Be();if(g(e))return b(e);a=setTimeout(m,function(e){var i=t-(e-l);return h?je(i,r-(e-c)):i}(e))}function b(e){return a=void 0,d&&n?p(e):(n=s=void 0,o)}function k(){var e=Be(),i=g(e);if(n=arguments,s=this,l=e,i){if(void 0===a)return f(l);if(h)return clearTimeout(a),a=setTimeout(m,t),p(l)}return void 0===a&&(a=setTimeout(m,t)),o}return t=Oe(t)||0,De(i)&&(u=!!i.leading,r=(h="maxWait"in i)?Ne(Oe(i.maxWait)||0,t):r,d="trailing"in i?!!i.trailing:d),k.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=s=a=void 0},k.flush=function(){return void 0===a?o:b(Be())},k})),qe={};Object.defineProperty(qe,"__esModule",{value:!0});var He=(lt=void 0,ct=qe.Emitter=lt,qe.Disposable=ct);qe.CompositeDisposable=He;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});var We=void 0;Ue.default=We;var Ze=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});var Ke=void 0;Ve.default=Ke;var Ge=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Xe=function(e){return e&&e.__esModule?e:{default:e}}(l);Ke=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,Xe.default)("function"==typeof t,"callback should be a function"),this.callback=t}return Ge(e,[{key:"dispose",value:function(){this.callback&&(this.callback(),this.callback=null)}},{key:"disposed",get:function(){return null===this.callback}}]),e}(),Ve.default=Ke;var Ye=function(e){return e&&e.__esModule?e:{default:e}}(Ve);We=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.disposed=!1,this.handlers={}}return Ze(e,[{key:"on",value:function(e,t){var i=this;if(this.disposed)throw new Error("Emitter has been disposed");if("function"!=typeof t)throw new Error("Event handler must be a function");var n=this.handlers[e];return void 0===n?n=this.handlers[e]=[t]:n.push(t),new Ye.default((function(){i.off(e,t)}))}},{key:"off",value:function(e,t){if(!this.disposed&&this.handlers[e]){var i=this.handlers[e].indexOf(t);-1!==i&&this.handlers[e].splice(i,1)}}},{key:"clear",value:function(){this.handlers={}}},{key:"emit",value:function(e){if(this.disposed)return Promise.resolve([]);if(!this.handlers[e])return Promise.resolve([]);for(var t=[],i=this.handlers[e],n=arguments.length,s=Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];for(var o=0,a=i.length;o<a;++o)t.push(i[o].apply(null,s));return Promise.all(t)}},{key:"dispose",value:function(){this.disposed=!0,this.clear()}}]),e}(),Ue.default=We;var Je=at(Ue),Qe=at(Ve),et={};Object.defineProperty(et,"__esModule",{value:!0});var tt=void 0;et.default=tt;var it=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),nt={};Object.defineProperty(nt,"__esModule",{value:!0});var st=function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t];if(!n||"function"!=typeof n.dispose&&"function"!=typeof n)throw new Error("Invalid disposable provided")}};function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}nt.validate=st,tt=function(){function e(){rt(this,e);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];(0,nt.validate)(i),this.disposed=!1,this.disposables=new Set(i)}return it(e,[{key:"add",value:function(){if(!this.disposed){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];(0,nt.validate)(t);for(var n=0,s=t.length;n<s;++n)this.disposables.add(t[n])}}},{key:"delete",value:function(){if(!this.disposed){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var n=0,s=t.length;n<s;++n)this.disposables.delete(t[n])}}},{key:"clear",value:function(){this.disposed||this.disposables.clear()}},{key:"dispose",value:function(){if(!this.disposed){var e=!0,t=!1,i=void 0;try{for(var n,s=this.disposables[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;"function"==typeof r.dispose?r.dispose():"function"==typeof r&&r()}}catch(e){t=!0,i=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw i}}this.disposed=!0,this.disposables.clear()}}}]),e}(),et.default=tt;var ot=at(et);function at(e){return e&&e.__esModule?e:{default:e}}var lt=Je.default;qe.Emitter=lt;var ct=Qe.default;qe.Disposable=ct,He=ot.default,qe.CompositeDisposable=He;var ut={Emitter:Je.default,Disposable:Qe.default,CompositeDisposable:ot.default};qe.default=ut;var ht=e((function(e,t,i,n){if(e.on)e.on(t,i,n);else if(e.addListener)e.addListener(t,i,n);else{if(!e.addEventListener)throw new Error("Unknown event emitter");e.addEventListener(t,i,n)}return new qe.Disposable((function(){if(e.off)e.off(t,i);else if(e.removeListener)e.removeListener(t,i);else{if(!e.removeEventListener)throw new Error("Unknown event emitter");e.removeEventListener(t,i)}}))}));class dt{constructor(){this.emitter=new v,this.expanded=!1,this.subscriptions=new k,this.subscriptions.add(this.emitter),this.subscriptions.add(atom.config.observe("linter-ui-default.showProviderName",(e=>{const t=void 0!==this.showProviderName;this.showProviderName=e,t&&this.emitter.emit("should-update")}))),this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-ui-default:expand-tooltip":e=>{var t;this.expanded||(this.expanded=!0,this.emitter.emit("should-expand"),(null===(t=null==e?void 0:e.originalEvent)||void 0===t?void 0:t.isTrusted)&&document.body.addEventListener("keyup",(function e(){document.body.removeEventListener("keyup",e),atom.commands.dispatch(atom.views.getView(atom.workspace),"linter-ui-default:collapse-tooltip")}),{passive:!0}))},"linter-ui-default:collapse-tooltip":()=>{this.expanded=!1,this.emitter.emit("should-collapse")}}))}onShouldUpdate(e){return this.emitter.on("should-update",e)}onShouldExpand(e){return this.emitter.on("should-expand",e)}onShouldCollapse(e){return this.emitter.on("should-collapse",e)}dispose(){this.emitter.dispose()}}var pt,ft,gt={};function mt(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}gt={defaults:{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:mt,changeDefaults:function(e){ft=e,gt.defaults=ft}};var bt={};const kt=/[&<>"']/,wt=/[&<>"']/g,vt=/[<>"']|&(?!#?\w+;)/,yt=/[<>"']|&(?!#?\w+;)/g,xt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},St=e=>xt[e];const Et=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function Pt(e){return e.replace(Et,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const _t=/(^|[^\[])\^/g;const Ct=/[^\w:]/g,Tt=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;const zt={},Rt=/^[^:]+:\/*[^/]*$/,$t=/^([^:]+:)[\s\S]*$/,At=/^([^:]+:\/*[^/]*)[\s\S]*$/;function It(e,t){zt[" "+e]||(Rt.test(e)?zt[" "+e]=e+"/":zt[" "+e]=Lt(e,"/",!0));const i=-1===(e=zt[" "+e]).indexOf(":");return"//"===t.substring(0,2)?i?t:e.replace($t,"$1")+t:"/"===t.charAt(0)?i?t:e.replace(At,"$1")+t:e+t}function Lt(e,t,i){const n=e.length;if(0===n)return"";let s=0;for(;s<n;){const r=e.charAt(n-s-1);if(r!==t||i){if(r===t||!i)break;s++}else s++}return e.substr(0,n-s)}function Mt(e,t,i){const n=t.href,s=t.title?bt.escape(t.title):null,r=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:i,href:n,title:s,text:r}:{type:"image",raw:i,href:n,title:s,text:bt.escape(r)}}bt={escape:function(e,t){if(t){if(kt.test(e))return e.replace(wt,St)}else if(vt.test(e))return e.replace(yt,St);return e},unescape:Pt,edit:function(e,t){e=e.source||e,t=t||"";const i={replace:(t,n)=>(n=(n=n.source||n).replace(_t,"$1"),e=e.replace(t,n),i),getRegex:()=>new RegExp(e,t)};return i},cleanUrl:function(e,t,i){if(e){let e;try{e=decodeURIComponent(Pt(i)).replace(Ct,"").toLowerCase()}catch(e){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!Tt.test(i)&&(i=It(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch(e){return null}return i},resolveUrl:It,noopTest:{exec:function(){}},merge:function(e){let t,i,n=1;for(;n<arguments.length;n++)for(i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},splitCells:function(e,t){const i=e.replace(/\|/g,((e,t,i)=>{let n=!1,s=t;for(;--s>=0&&"\\"===i[s];)n=!n;return n?"|":" |"})).split(/ \|/);let n=0;if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i},rtrim:Lt,findClosingBracket:function(e,t){if(-1===e.indexOf(t[1]))return-1;const i=e.length;let n=0,s=0;for(;s<i;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1},checkSanitizeDeprecation:function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},repeatString:function(e,t){if(t<1)return"";let i="";for(;t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e}};const Dt=pt=class{constructor(e){this.options=e||ft}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}}code(e,t){const i=this.rules.block.code.exec(e);if(i){const e=t[t.length-1];if(e&&"paragraph"===e.type)return{raw:i[0],text:i[0].trimRight()};const n=i[0].replace(/^ {4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:this.options.pedantic?n:bt.rtrim(n,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],i=function(e,t){const i=e.match(/^(\s+)(?:```)/);if(null===i)return t;const n=i[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[i]=t;return i.length>=n.length?e.slice(n.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=bt.rtrim(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e}}}nptable(e){const t=this.rules.block.nptable.exec(e);if(t){const e={type:"table",header:bt.splitCells(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(e.header.length===e.align.length){let t,i=e.align.length;for(t=0;t<i;t++)/^ *-+: *$/.test(e.align[t])?e.align[t]="right":/^ *:-+: *$/.test(e.align[t])?e.align[t]="center":/^ *:-+ *$/.test(e.align[t])?e.align[t]="left":e.align[t]=null;for(i=e.cells.length,t=0;t<i;t++)e.cells[t]=bt.splitCells(e.cells[t],e.header.length);return e}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:e}}}list(e){const t=this.rules.block.list.exec(e);if(t){let e=t[0];const i=t[2],n=i.length>1,s={type:"list",raw:e,ordered:n,start:n?+i.slice(0,-1):"",loose:!1,items:[]},r=t[0].match(this.rules.block.item);let o,a,l,c,u,h,d,p,f=!1,g=r.length;l=this.rules.block.listItemStart.exec(r[0]);for(let t=0;t<g;t++){if(o=r[t],e=o,t!==g-1){if(c=this.rules.block.listItemStart.exec(r[t+1]),c[1].length>l[0].length||c[1].length>3){r.splice(t,2,r[t]+"\n"+r[t+1]),t--,g--;continue}(!this.options.pedantic||this.options.smartLists?c[2][c[2].length-1]!==i[i.length-1]:n===(1===c[2].length))&&(u=r.slice(t+1).join("\n"),s.raw=s.raw.substring(0,s.raw.length-u.length),t=g-1),l=c}a=o.length,o=o.replace(/^ *([*+-]|\d+[.)]) ?/,""),~o.indexOf("\n ")&&(a-=o.length,o=this.options.pedantic?o.replace(/^ {1,4}/gm,""):o.replace(new RegExp("^ {1,"+a+"}","gm"),"")),h=f||/\n\n(?!\s*$)/.test(o),t!==g-1&&(f="\n"===o.charAt(o.length-1),h||(h=f)),h&&(s.loose=!0),this.options.gfm&&(d=/^\[[ xX]\] /.test(o),p=void 0,d&&(p=" "!==o[1],o=o.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:e,task:d,checked:p,loose:h,text:o})}return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):bt.escape(t[0]):t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));return{tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:bt.splitCells(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let i,n=e.align.length;for(i=0;i<n;i++)/^ *-+: *$/.test(e.align[i])?e.align[i]="right":/^ *:-+: *$/.test(e.align[i])?e.align[i]="center":/^ *:-+ *$/.test(e.align[i])?e.align[i]="left":e.align[i]=null;for(n=e.cells.length,i=0;i<n;i++)e.cells[i]=bt.splitCells(e.cells[i].replace(/^ *\| *| *\| *$/g,""),e.header.length);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}}text(e,t){const i=this.rules.block.text.exec(e);if(i){const e=t[t.length-1];return e&&"text"===e.type?{raw:i[0],text:i[0]}:{type:"text",raw:i[0],text:i[0]}}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:bt.escape(t[1])}}tag(e,t,i){const n=this.rules.inline.tag.exec(e);if(n)return!t&&/^<a /i.test(n[0])?t=!0:t&&/^<\/a>/i.test(n[0])&&(t=!1),!i&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?i=!0:i&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(i=!1),{type:this.options.sanitize?"text":"html",raw:n[0],inLink:t,inRawBlock:i,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):bt.escape(n[0]):n[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=bt.rtrim(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=bt.findClosingBracket(t[2],"()");if(e>-1){const i=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let i=t[2],n="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);e&&(i=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(i=this.options.pedantic&&!/>$/.test(e)?i.slice(1):i.slice(1,-1)),Mt(t,{href:i?i.replace(this.rules.inline._escapes,"$1"):i,title:n?n.replace(this.rules.inline._escapes,"$1"):n},t[0])}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let e=(i[2]||i[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){const e=i[0].charAt(0);return{type:"text",raw:e,text:e}}return Mt(i,e,i[0])}}strong(e,t,i=""){let n=this.rules.inline.strong.start.exec(e);if(n&&(!n[1]||n[1]&&(""===i||this.rules.inline.punctuation.exec(i)))){t=t.slice(-1*e.length);const i="**"===n[0]?this.rules.inline.strong.endAst:this.rules.inline.strong.endUnd;let s;for(i.lastIndex=0;null!=(n=i.exec(t));)if(s=this.rules.inline.strong.middle.exec(t.slice(0,n.index+3)),s)return{type:"strong",raw:e.slice(0,s[0].length),text:e.slice(2,s[0].length-2)}}}em(e,t,i=""){let n=this.rules.inline.em.start.exec(e);if(n&&(!n[1]||n[1]&&(""===i||this.rules.inline.punctuation.exec(i)))){t=t.slice(-1*e.length);const i="*"===n[0]?this.rules.inline.em.endAst:this.rules.inline.em.endUnd;let s;for(i.lastIndex=0;null!=(n=i.exec(t));)if(s=this.rules.inline.em.middle.exec(t.slice(0,n.index+2)),s)return{type:"em",raw:e.slice(0,s[0].length),text:e.slice(1,s[0].length-1)}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const i=/[^ ]/.test(e),n=/^ /.test(e)&&/ $/.test(e);return i&&n&&(e=e.substring(1,e.length-1)),e=bt.escape(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2]}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let e,n;return"@"===i[2]?(e=bt.escape(this.options.mangle?t(i[1]):i[1]),n="mailto:"+e):(e=bt.escape(i[1]),n=e),{type:"link",raw:i[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let e,n;if("@"===i[2])e=bt.escape(this.options.mangle?t(i[0]):i[0]),n="mailto:"+e;else{let t;do{t=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0]}while(t!==i[0]);e=bt.escape(i[0]),n="www."===i[1]?"http://"+e:e}return{type:"link",raw:i[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t,i){const n=this.rules.inline.text.exec(e);if(n){let e;return e=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):bt.escape(n[0]):n[0]:bt.escape(this.options.smartypants?i(n[0]):n[0]),{type:"text",raw:n[0],text:e}}}};var Bt;const Ot={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:bt.noopTest,table:bt.noopTest,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Ot.def=bt.edit(Ot.def).replace("label",Ot._label).replace("title",Ot._title).getRegex(),Ot.bullet=/(?:[*+-]|\d{1,9}[.)])/,Ot.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Ot.item=bt.edit(Ot.item,"gm").replace(/bull/g,Ot.bullet).getRegex(),Ot.listItemStart=bt.edit(/^( *)(bull)/).replace("bull",Ot.bullet).getRegex(),Ot.list=bt.edit(Ot.list).replace(/bull/g,Ot.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ot.def.source+")").getRegex(),Ot._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ot._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Ot.html=bt.edit(Ot.html,"i").replace("comment",Ot._comment).replace("tag",Ot._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ot.paragraph=bt.edit(Ot._paragraph).replace("hr",Ot.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Ot._tag).getRegex(),Ot.blockquote=bt.edit(Ot.blockquote).replace("paragraph",Ot.paragraph).getRegex(),Ot.normal=bt.merge({},Ot),Ot.gfm=bt.merge({},Ot.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Ot.gfm.nptable=bt.edit(Ot.gfm.nptable).replace("hr",Ot.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Ot._tag).getRegex(),Ot.gfm.table=bt.edit(Ot.gfm.table).replace("hr",Ot.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",Ot._tag).getRegex(),Ot.pedantic=bt.merge({},Ot.normal,{html:bt.edit("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Ot._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:bt.noopTest,paragraph:bt.edit(Ot.normal._paragraph).replace("hr",Ot.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Ot.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Nt={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:bt.noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",strong:{start:/^(?:(\*\*(?=[*punctuation]))|\*\*)(?![\s])|__/,middle:/^\*\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*\*$|^__(?![\s])((?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?)__$/,endAst:/[^punctuation\s]\*\*(?!\*)|[punctuation]\*\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]__(?!_)(?:(?=[punctuation*\s])|$)/},em:{start:/^(?:(\*(?=[punctuation]))|\*)(?![*\s])|_/,middle:/^\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*$|^_(?![_\s])(?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?_$/,endAst:/[^punctuation\s]\*(?!\*)|[punctuation]\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]_(?!_)(?:(?=[punctuation*\s])|$)/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:bt.noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\s*punctuation])/};function jt(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Ft(e){let t,i,n="";const s=e.length;for(t=0;t<s;t++)i=e.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),n+="&#"+i+";";return n}Nt._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",Nt.punctuation=bt.edit(Nt.punctuation).replace(/punctuation/g,Nt._punctuation).getRegex(),Nt._blockSkip="\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>",Nt._overlapSkip="__[^_]*?__|\\*\\*\\[^\\*\\]*?\\*\\*",Nt._comment=bt.edit(Ot._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Nt.em.start=bt.edit(Nt.em.start).replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.em.middle=bt.edit(Nt.em.middle).replace(/punctuation/g,Nt._punctuation).replace(/overlapSkip/g,Nt._overlapSkip).getRegex(),Nt.em.endAst=bt.edit(Nt.em.endAst,"g").replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.em.endUnd=bt.edit(Nt.em.endUnd,"g").replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.strong.start=bt.edit(Nt.strong.start).replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.strong.middle=bt.edit(Nt.strong.middle).replace(/punctuation/g,Nt._punctuation).replace(/overlapSkip/g,Nt._overlapSkip).getRegex(),Nt.strong.endAst=bt.edit(Nt.strong.endAst,"g").replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.strong.endUnd=bt.edit(Nt.strong.endUnd,"g").replace(/punctuation/g,Nt._punctuation).getRegex(),Nt.blockSkip=bt.edit(Nt._blockSkip,"g").getRegex(),Nt.overlapSkip=bt.edit(Nt._overlapSkip,"g").getRegex(),Nt._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Nt._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Nt._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Nt.autolink=bt.edit(Nt.autolink).replace("scheme",Nt._scheme).replace("email",Nt._email).getRegex(),Nt._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Nt.tag=bt.edit(Nt.tag).replace("comment",Nt._comment).replace("attribute",Nt._attribute).getRegex(),Nt._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Nt._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Nt._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Nt.link=bt.edit(Nt.link).replace("label",Nt._label).replace("href",Nt._href).replace("title",Nt._title).getRegex(),Nt.reflink=bt.edit(Nt.reflink).replace("label",Nt._label).getRegex(),Nt.reflinkSearch=bt.edit(Nt.reflinkSearch,"g").replace("reflink",Nt.reflink).replace("nolink",Nt.nolink).getRegex(),Nt.normal=bt.merge({},Nt),Nt.pedantic=bt.merge({},Nt.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:bt.edit(/^!?\[(label)\]\((.*?)\)/).replace("label",Nt._label).getRegex(),reflink:bt.edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Nt._label).getRegex()}),Nt.gfm=bt.merge({},Nt.normal,{escape:bt.edit(Nt.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),Nt.gfm.url=bt.edit(Nt.gfm.url,"i").replace("email",Nt.gfm._extended_email).getRegex(),Nt.breaks=bt.merge({},Nt.gfm,{br:bt.edit(Nt.br).replace("{2,}","*").getRegex(),text:bt.edit(Nt.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),Bt={block:Ot,inline:Nt};const qt=class e{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ft,this.options.tokenizer=this.options.tokenizer||new Dt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;const t={block:Bt.block.normal,inline:Bt.inline.normal};this.options.pedantic?(t.block=Bt.block.pedantic,t.inline=Bt.inline.pedantic):this.options.gfm&&(t.block=Bt.block.gfm,this.options.breaks?t.inline=Bt.inline.breaks:t.inline=Bt.inline.gfm),this.tokenizer.rules=t}static get rules(){return{block:Bt.block,inline:Bt.inline}}static lex(t,i){return new e(i).lex(t)}static lexInline(t,i){return new e(i).inlineTokens(t)}lex(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens}blockTokens(e,t=[],i=!0){let n,s,r,o;for(e=e.replace(/^ +$/gm,"");e;)if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),n.type&&t.push(n);else if(n=this.tokenizer.code(e,t))e=e.substring(n.raw.length),n.type?t.push(n):(o=t[t.length-1],o.raw+="\n"+n.raw,o.text+="\n"+n.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.nptable(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),n.tokens=this.blockTokens(n.text,[],i),t.push(n);else if(n=this.tokenizer.list(e)){for(e=e.substring(n.raw.length),r=n.items.length,s=0;s<r;s++)n.items[s].tokens=this.blockTokens(n.items[s].text,[],!1);t.push(n)}else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(i&&(n=this.tokenizer.def(e)))e=e.substring(n.raw.length),this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else if(i&&(n=this.tokenizer.paragraph(e)))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.text(e,t))e=e.substring(n.raw.length),n.type?t.push(n):(o=t[t.length-1],o.raw+="\n"+n.raw,o.text+="\n"+n.text);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}return t}inline(e){let t,i,n,s,r,o;const a=e.length;for(t=0;t<a;t++)switch(o=e[t],o.type){case"paragraph":case"text":case"heading":o.tokens=[],this.inlineTokens(o.text,o.tokens);break;case"table":for(o.tokens={header:[],cells:[]},s=o.header.length,i=0;i<s;i++)o.tokens.header[i]=[],this.inlineTokens(o.header[i],o.tokens.header[i]);for(s=o.cells.length,i=0;i<s;i++)for(r=o.cells[i],o.tokens.cells[i]=[],n=0;n<r.length;n++)o.tokens.cells[i][n]=[],this.inlineTokens(r[n],o.tokens.cells[i][n]);break;case"blockquote":this.inline(o.tokens);break;case"list":for(s=o.items.length,i=0;i<s;i++)this.inline(o.items[i].tokens)}return e}inlineTokens(e,t=[],i=!1,n=!1){let s,r,o,a,l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,r.index)+"["+bt.repeatString("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,r.index)+"["+bt.repeatString("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;e;)if(o||(a=""),o=!1,s=this.tokenizer.escape(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.tag(e,i,n))e=e.substring(s.raw.length),i=s.inLink,n=s.inRawBlock,t.push(s);else if(s=this.tokenizer.link(e))e=e.substring(s.raw.length),"link"===s.type&&(s.tokens=this.inlineTokens(s.text,[],!0,n)),t.push(s);else if(s=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(s.raw.length),"link"===s.type&&(s.tokens=this.inlineTokens(s.text,[],!0,n)),t.push(s);else if(s=this.tokenizer.strong(e,l,a))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],i,n),t.push(s);else if(s=this.tokenizer.em(e,l,a))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],i,n),t.push(s);else if(s=this.tokenizer.codespan(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.br(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.del(e))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],i,n),t.push(s);else if(s=this.tokenizer.autolink(e,Ft))e=e.substring(s.raw.length),t.push(s);else if(i||!(s=this.tokenizer.url(e,Ft))){if(s=this.tokenizer.inlineText(e,n,jt))e=e.substring(s.raw.length),a=s.raw.slice(-1),o=!0,t.push(s);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(s.raw.length),t.push(s);return t}};var Ht;const Ut=Ht=class{constructor(e){this.options=e||ft}code(e,t,i){const n=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,n);null!=t&&t!==e&&(i=!0,e=t)}return n?'<pre><code class="'+this.options.langPrefix+bt.escape(n,!0)+'">'+(i?e:bt.escape(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:bt.escape(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n"+e+"</blockquote>\n"}html(e){return e}heading(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,i){const n=t?"ol":"ul";return"<"+n+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+n+">\n"}listitem(e){return"<li>"+e+"</li>\n"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+"</p>\n"}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n"+e+"</tr>\n"}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+">\n"}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(null===(e=bt.cleanUrl(this.options.sanitize,this.options.baseUrl,e)))return i;let n='<a href="'+bt.escape(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n}image(e,t,i){if(null===(e=bt.cleanUrl(this.options.sanitize,this.options.baseUrl,e)))return i;let n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">",n}text(e){return e}};var Wt;const Zt=Wt=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}};var Vt;const Kt=Vt=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do{n++,i=e+"-"+n}while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}},Gt=class e{constructor(e){this.options=e||ft,this.options.renderer=this.options.renderer||new Ut,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Zt,this.slugger=new Kt}static parse(t,i){return new e(i).parse(t)}static parseInline(t,i){return new e(i).parseInline(t)}parse(e,t=!0){let i,n,s,r,o,a,l,c,u,h,d,p,f,g,m,b,k,w,v="";const y=e.length;for(i=0;i<y;i++)switch(h=e[i],h.type){case"space":continue;case"hr":v+=this.renderer.hr();continue;case"heading":v+=this.renderer.heading(this.parseInline(h.tokens),h.depth,bt.unescape(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":v+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",l="",r=h.header.length,n=0;n<r;n++)l+=this.renderer.tablecell(this.parseInline(h.tokens.header[n]),{header:!0,align:h.align[n]});for(c+=this.renderer.tablerow(l),u="",r=h.cells.length,n=0;n<r;n++){for(a=h.tokens.cells[n],l="",o=a.length,s=0;s<o;s++)l+=this.renderer.tablecell(this.parseInline(a[s]),{header:!1,align:h.align[s]});u+=this.renderer.tablerow(l)}v+=this.renderer.table(c,u);continue;case"blockquote":u=this.parse(h.tokens),v+=this.renderer.blockquote(u);continue;case"list":for(d=h.ordered,p=h.start,f=h.loose,r=h.items.length,u="",n=0;n<r;n++)m=h.items[n],b=m.checked,k=m.task,g="",m.task&&(w=this.renderer.checkbox(b),f?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=w+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=w+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:w}):g+=w),g+=this.parse(m.tokens,f),u+=this.renderer.listitem(g,k,b);v+=this.renderer.list(u,d,p);continue;case"html":v+=this.renderer.html(h.text);continue;case"paragraph":v+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(u=h.tokens?this.parseInline(h.tokens):h.text;i+1<y&&"text"===e[i+1].type;)h=e[++i],u+="\n"+(h.tokens?this.parseInline(h.tokens):h.text);v+=t?this.renderer.paragraph(u):u;continue;default:{const e='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return v}parseInline(e,t){t=t||this.renderer;let i,n,s="";const r=e.length;for(i=0;i<r;i++)switch(n=e[i],n.type){case"escape":s+=t.text(n.text);break;case"html":s+=t.html(n.text);break;case"link":s+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":s+=t.image(n.href,n.title,n.text);break;case"strong":s+=t.strong(this.parseInline(n.tokens,t));break;case"em":s+=t.em(this.parseInline(n.tokens,t));break;case"codespan":s+=t.codespan(n.text);break;case"br":s+=t.br();break;case"del":s+=t.del(this.parseInline(n.tokens,t));break;case"text":s+=t.text(n.text);break;default:{const e='Token with "'+n.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return s}},Xt=pt,Yt=Ht,Jt=Wt,Qt=Vt;function ei(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(i=t,t=null),t=bt.merge({},ei.defaults,t||{}),bt.checkSanitizeDeprecation(t),i){const n=t.highlight;let s;try{s=qt.lex(e,t)}catch(e){return i(e)}const r=function(e){let r;if(!e)try{r=Gt.parse(s,t)}catch(t){e=t}return t.highlight=n,e?i(e):i(null,r)};if(!n||n.length<3)return r();if(delete t.highlight,!s.length)return r();let o=0;return ei.walkTokens(s,(function(e){"code"===e.type&&(o++,setTimeout((()=>{n(e.text,e.lang,(function(t,i){if(t)return r(t);null!=i&&i!==e.text&&(e.text=i,e.escaped=!0),o--,0===o&&r()}))}),0))})),void(0===o&&r())}try{const i=qt.lex(e,t);return t.walkTokens&&ei.walkTokens(i,t.walkTokens),Gt.parse(i,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+bt.escape(e.message+"",!0)+"</pre>";throw e}}ei.options=ei.setOptions=function(e){return bt.merge(ei.defaults,e),gt.changeDefaults(ei.defaults),ei},ei.getDefaults=gt.getDefaults,ei.defaults=ft,ei.use=function(e){const t=bt.merge({},e);if(e.renderer){const i=ei.defaults.renderer||new Yt;for(const t in e.renderer){const n=i[t];i[t]=(...s)=>{let r=e.renderer[t].apply(i,s);return!1===r&&(r=n.apply(i,s)),r}}t.renderer=i}if(e.tokenizer){const i=ei.defaults.tokenizer||new Xt;for(const t in e.tokenizer){const n=i[t];i[t]=(...s)=>{let r=e.tokenizer[t].apply(i,s);return!1===r&&(r=n.apply(i,s)),r}}t.tokenizer=i}if(e.walkTokens){const i=ei.defaults.walkTokens;t.walkTokens=t=>{e.walkTokens(t),i&&i(t)}}ei.setOptions(t)},ei.walkTokens=function(e,t){for(const i of e)switch(t(i),i.type){case"table":for(const e of i.tokens.header)ei.walkTokens(e,t);for(const e of i.tokens.cells)for(const i of e)ei.walkTokens(i,t);break;case"list":ei.walkTokens(i.items,t);break;default:i.tokens&&ei.walkTokens(i.tokens,t)}},ei.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=bt.merge({},ei.defaults,t||{}),bt.checkSanitizeDeprecation(t);try{const i=qt.lexInline(e,t);return t.walkTokens&&ei.walkTokens(i,t.walkTokens),Gt.parseInline(i,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+bt.escape(e.message+"",!0)+"</pre>";throw e}},ei.Parser=Gt,ei.parser=Gt.parse,ei.Renderer=Yt,ei.TextRenderer=Jt,ei.Lexer=qt,ei.lexer=qt.lex,ei.Tokenizer=Xt,ei.Slugger=Qt,ei.parse=ei;var ti=e(ei),ii=({onClick:e})=>p.createElement("button",{className:"linter-ui-default-fix-btn",onClick:e},"Fix");function ni(e){let t=!1;const[i,n]=g({description:"",descriptionShow:!1});function s(r=null){const o=!i.descriptionShow,a=i.description||e.message.description;if(o||r)if("string"==typeof a||r){const e=ti(r||a);n({description:e,descriptionShow:!0})}else if("function"==typeof a){if(n({...i,descriptionShow:!0}),t)return;t=!0,new Promise((function(e){e(a())})).then((e=>{if("string"!=typeof e)throw new Error("Expected result to be string, got: "+typeof e);s(e)})).catch((e=>{console.log("[Linter] Error getting descriptions",e),t=!1,i.descriptionShow&&s()}))}else console.error("[Linter] Invalid description detected, expected string or function but got:",typeof a);else n({...i,descriptionShow:!1})}f((()=>{e.delegate.onShouldUpdate((()=>{n({description:"",descriptionShow:!1})})),e.delegate.onShouldExpand((()=>{i.descriptionShow||s()})),e.delegate.onShouldCollapse((()=>{i.descriptionShow&&s()}))}),[]);const{message:r,delegate:a}=e;return p.createElement("div",{className:`linter-message ${r.severity}`,onClick:function(e){if(!(e.target instanceof HTMLElement))return;const t=function(e){for(;e&&!e.classList.contains("linter-line");){if(e instanceof HTMLAnchorElement)return e.href;e=e.parentElement}return null}(e.target);if(!t)return;const{protocol:i,hostname:n,query:s}=o(t,!0);if("atom:"===i&&"linter"===n&&s&&s.file){const{file:e,row:t,column:i}=s;A(Array.isArray(e)?e[0]:e,{row:t?parseInt(Array.isArray(t)?t[0]:t,10):0,column:i?parseInt(Array.isArray(i)?i[0]:i,10):0})}}},r.description&&p.createElement("a",{href:"#",onClick:()=>s()},p.createElement("span",{className:"icon linter-icon icon-"+(i.descriptionShow?"chevron-down":"chevron-right")})),p.createElement("div",{className:"linter-excerpt"},function(e){return!(2!==e.version||!e.solutions||!e.solutions.length)}(r)&&p.createElement(ii,{onClick:()=>function(){const t=e.message,i=z();null!==i&&2===t.version&&t.solutions&&t.solutions.length&&B(i,D(t.solutions)[0])}()}),a.showProviderName?`${r.linterName}: `:"",r.excerpt)," ",r.reference&&r.reference.file&&p.createElement("a",{href:"#",onClick:()=>I(r,!0)},p.createElement("span",{className:"icon linter-icon icon-alignment-aligned-to"})),r.url&&p.createElement("a",{href:"#",onClick:()=>L(r)},p.createElement("span",{className:"icon linter-icon icon-link"})),i.descriptionShow&&p.createElement("div",{dangerouslySetInnerHTML:{__html:i.description||"Loading..."},className:"linter-line"}))}class si{constructor(e,t,i){this.element=document.createElement("div"),this.emitter=new v,this.subscriptions=new k,this.messages=e,this.subscriptions,this.subscriptions.add(this.emitter),this.marker=i.markBufferRange([t,t]),this.marker.onDidDestroy((()=>this.emitter.emit("did-destroy")));const n=new dt;this.element.id="linter-tooltip",i.decorateMarker(this.marker,{type:"overlay",item:this.element}),this.subscriptions.add(n);const s=[];e.forEach((e=>{2===e.version&&s.push(p.createElement(ni,{key:e.key,delegate:n,message:e}))})),u.render(p.createElement("div",{className:"linter-messages"},s),this.element),setTimeout((()=>{const e=this.element.getBoundingClientRect().height,n=i.getLineHeightInPixels();if(e<(t.row-i.getFirstVisibleScreenRow())*n){const t=this.element.parentElement;t&&(t.style.transform=`translateY(-${2+n+e}px)`)}this.element.style.visibility="visible"}),50)}isValid(e,t){if(1!==this.messages.length||!t.has(this.messages[0].key))return!1;const i=_(this.messages[0]);return Boolean(i&&i.containsPoint(e))}onDidDestroy(e){return this.emitter.on("did-destroy",e)}dispose(){this.emitter.emit("did-destroy"),this.subscriptions.dispose()}}class ri{constructor(e){this.gutter=null,this.tooltip=null,this.showTooltip=!0,this.cursorPosition=null,this.tooltipFollows="Both",this.showProviderName=!0,this.currentLineMarker=null,this.emitter=new v,this.markers=new Map,this.messages=new Map,this.textEditor=e,this.subscriptions=new k,this.ignoreTooltipInvocation=!1,this.lastCursorPositions=new WeakMap,this.subscriptions.add(this.emitter),this.subscriptions.add(atom.config.observe("linter-ui-default.showTooltip",(e=>{this.showTooltip=e,!this.showTooltip&&this.tooltip&&this.removeTooltip()}))),this.subscriptions.add(atom.config.observe("linter-ui-default.showProviderName",(e=>{this.showProviderName=e}))),this.subscriptions.add(atom.config.observe("linter-ui-default.showDecorations",(e=>{const t=void 0!==this.showDecorations;this.showDecorations=e,t&&this.updateGutter()}))),this.subscriptions.add(atom.config.observe("linter-ui-default.gutterPosition",(e=>{const t=void 0!==this.gutterPosition;this.gutterPosition=e,t&&this.updateGutter()}))),this.subscriptions.add(e.onDidDestroy((()=>{this.dispose()})));let t=null;this.subscriptions.add(atom.config.observe("linter-ui-default.tooltipFollows",(e=>{this.tooltipFollows=e,t&&t.dispose(),t=new k,"Mouse"!==e&&"Both"!==e||t.add(this.listenForMouseMovement()),"Keyboard"!==e&&"Both"!==e||t.add(this.listenForKeyboardMovement()),this.removeTooltip()}))),this.subscriptions.add(new w((function(){null==t||t.dispose()}))),this.subscriptions.add(e.onDidChangeCursorPosition((({cursor:e,newBufferPosition:t})=>{const i=this.lastCursorPositions.get(e);i&&i.isEqual(t)||(this.lastCursorPositions.set(e,t),this.ignoreTooltipInvocation=!1),"Mouse"===this.tooltipFollows&&this.removeTooltip()}))),this.subscriptions.add(e.getBuffer().onDidChangeText((()=>{e.getCursors().forEach((e=>{this.lastCursorPositions.set(e,e.getBufferPosition())})),"Mouse"!==this.tooltipFollows&&(this.ignoreTooltipInvocation=!0,this.removeTooltip())}))),this.updateGutter(),this.listenForCurrentLine()}listenForCurrentLine(){this.subscriptions.add(this.textEditor.observeCursors((e=>{const t=({start:e,end:t})=>{const i=this.gutter;if(!i||this.subscriptions.disposed)return;const n=y.fromObject([e,t]),s=y.fromObject([[e.row,0],[t.row,1/0]]),r=n.isEmpty();if(e.row!==t.row&&0===n.end.column&&s.end.row--,this.lastRange&&this.lastRange.isEqual(s)&&r===this.lastIsEmpty)return;this.currentLineMarker&&(this.currentLineMarker.destroy(),this.currentLineMarker=null),this.lastRange=s,this.lastIsEmpty=r,this.currentLineMarker=this.textEditor.markScreenRange(s,{invalidate:"never"});const o=document.createElement("span");o.className="line-number cursor-line linter-cursor-line "+(r?"cursor-line-no-selection":""),i.decorateMarker(this.currentLineMarker,{item:o,class:"linter-row"})},i=e.getMarker(),n=new k;n.add(i.onDidChange((({newHeadScreenPosition:e,newTailScreenPosition:i})=>{t({start:e,end:i})}))),n.add(e.onDidDestroy((()=>{this.subscriptions.remove(n),n.dispose()}))),n.add(new w((()=>{this.currentLineMarker&&(this.currentLineMarker.destroy(),this.currentLineMarker=null)}))),this.subscriptions.add(n),t(i.getScreenRange())})))}listenForMouseMovement(){const e=atom.views.getView(this.textEditor);return ht(e,"mousemove",Fe((t=>{if(!e.getComponent()||this.subscriptions.disposed||!function(e,t){let i=e;do{if(i.matches(t))return!0;i=i.parentElement}while(i&&"HTML"!==i.nodeName);return!1}(t.target,"div.scroll-view"))return;const i=this.tooltip;i&&function({event:e,editor:t,editorElement:i,tooltipElement:n,screenPosition:s}){const r=i.getComponent().pixelPositionForMouseEvent(e),o=i.pixelPositionForScreenPosition(s),a=r.top-o.top,l=r.left-o.left,c=t.getLineHeightInPixels(),u=n.offsetHeight+c,h=n.offsetWidth;if(a>0){if(a>u+1.5*c)return!1}else if(a<0&&a<-1.5*c)return!1;if(l>0){if(l>h+30)return!1}else if(l<0&&l<-30)return!1;return!0}({event:t,editor:this.textEditor,editorElement:e,tooltipElement:i.element,screenPosition:i.marker.getStartScreenPosition()})||(this.cursorPosition=function(e,t,i){const n=i.getComponent().pixelPositionForMouseEvent(e),s=i.getComponent().screenPositionForPixelPosition(n);if(Number.isNaN(s.row)||Number.isNaN(s.column))return null;const r=i.pixelPositionForScreenPosition(s),o=n.top-r.top,a=n.left-r.left;return(0===o||o>0&&o<20||o<0&&o>-20)&&(0===a||a>0&&a<20||a<0&&a>-20)?t.bufferPositionForScreenPosition(s):null}(t,this.textEditor,e),this.ignoreTooltipInvocation=!1,this.cursorPosition?this.updateTooltip(this.cursorPosition):this.removeTooltip())}),100),{passive:!0})}listenForKeyboardMovement(){return this.textEditor.onDidChangeCursorPosition(Fe((({newBufferPosition:e})=>{this.cursorPosition=e,this.updateTooltip(e)}),16))}updateGutter(){if(this.removeGutter(),!this.showDecorations)return void(this.gutter=null);const e="Left"===this.gutterPosition?-100:100;this.gutter=this.textEditor.addGutter({name:"linter-ui-default",priority:e}),this.markers.forEach(((e,t)=>{const i=this.messages.get(t);if(i)for(const t of e)this.decorateMarker(i,t,"gutter")}))}removeGutter(){if(this.gutter)try{this.gutter.destroy()}catch(e){}}updateTooltip(e){if(!e||this.tooltip&&this.tooltip.isValid(e,this.messages))return;if(this.removeTooltip(),!this.showTooltip)return;if(this.ignoreTooltipInvocation)return;const t=$(this.messages,this.textEditor.getPath(),e);if(!t.length)return;this.tooltip=new si(t,e,this.textEditor);const i=this.tooltip.marker;t.forEach((e=>{this.saveMarker(e.key,i)})),this.tooltip.onDidDestroy((()=>{this.tooltip=null}))}removeTooltip(){this.tooltip&&this.tooltip.marker.destroy()}apply(e,t){const i=this.textEditor.getBuffer();for(let e=0,i=t.length;e<i;e++){const i=t[e];this.destroyMarker(i.key)}for(let t=0,n=e.length;t<n;t++){const n=e[t],s=_(n);if(!s)continue;const r=i.markRange(s,{invalidate:"never"});this.decorateMarker(n,r),r.onDidChange((({oldHeadPosition:e,newHeadPosition:t,isValid:i})=>{!i||0===t.row&&0!==e.row||2===n.version&&(n.location.position=r.previousEventState.range)}))}this.updateTooltip(this.cursorPosition)}decorateMarker(e,t,i="both"){this.saveMarker(e.key,t),this.messages.set(e.key,e),"both"!==i&&"editor"!==i||this.textEditor.decorateMarker(t,{type:"text",class:`linter-highlight linter-${e.severity}`});const n=this.gutter;if(n&&("both"===i||"gutter"===i)){const i=document.createElement("span");i.className=`linter-gutter linter-gutter-${e.severity} icon icon-${e.icon||"primitive-dot"}`,n.decorateMarker(t,{class:"linter-row",item:i})}}saveMarker(e,t){const i=this.markers.get(e)||[];i.push(t),this.markers.set(e,i)}destroyMarker(e){const t=this.markers.get(e);t&&t.forEach((e=>{e&&e.destroy()})),this.markers.delete(e),this.messages.delete(e)}onDidDestroy(e){return this.emitter.on("did-destroy",e)}dispose(){this.emitter.emit("did-destroy"),this.subscriptions.dispose(),this.removeGutter(),this.removeTooltip()}}class oi{constructor(){this.editors=new Set,this.messages=[],this.firstRender=!0,this.subscriptions=new k,this.subscriptions.add(atom.workspace.observeTextEditors((e=>{if(function(e){const t=e.getLineCount();if(e.largeFileMode||t>=O)return!0;const i=e.getBuffer();for(let e=0,n=t;e<n;e++)if(i.lineLengthForRow(e)>N)return!0;return!1}(e)){const t=atom.notifications.addWarning("Linter: Large/Minified file detected",{detail:"Adding inline linter markers are skipped for this file for performance reasons (linter pane is still active)",dismissable:!0,buttons:[{text:"Force enable",onDidClick:()=>{this.getEditor(e),t.dismiss()}},{text:"Change threshold",onDidClick:async()=>{var e;await atom.workspace.open("atom://config/packages/linter-ui-default"),null===(e=document.querySelectorAll(".control-group")[16])||void 0===e||e.scrollIntoView(),t.dismiss()}}]});setTimeout((()=>{t.dismiss()}),5e3)}else this.getEditor(e)}))),this.subscriptions.add(atom.workspace.getCenter().observeActivePaneItem((e=>{this.editors.forEach((t=>{t.textEditor!==e&&t.removeTooltip()}))})))}isFirstRender(){return this.firstRender}update({messages:e,added:t,removed:i}){this.messages=e,this.firstRender=!1;const{editorsMap:n,filePaths:s}=function(e){var t;const i=new Map,n=[];for(const s of e.editors){const e=null!==(t=s.textEditor.getPath())&&void 0!==t?t:"";i.has(e)?i.get(e).editors.push(s):(i.set(e,{added:[],removed:[],editors:[s]}),n.push(e))}return{editorsMap:i,filePaths:n}}(this);t.forEach((function(e){if(!e||!e.location)return;const t=C(e);t&&n.has(t)&&n.get(t).added.push(e)})),i.forEach((function(e){if(!e||!e.location)return;const t=C(e);t&&n.has(t)&&n.get(t).removed.push(e)})),s.forEach((function(e){if(n.has(e)){const{added:t,removed:i,editors:s}=n.get(e);(t.length||i.length)&&s.forEach((e=>e.apply(t,i)))}}))}getEditor(e){for(const t of this.editors)if(t.textEditor===e)return t;const t=new ri(e);return this.editors.add(t),t.onDidDestroy((()=>{this.editors.delete(t)})),t.subscriptions.add(e.onDidChangePath((()=>{t.dispose(),this.getEditor(e)}))),t.subscriptions.add(e.onDidChangeGrammar((()=>{t.dispose(),this.getEditor(e)}))),t.apply(R(this.messages,e.getPath()),[]),t}dispose(){for(const e of this.editors)e.dispose();this.subscriptions.dispose()}}function ai(e,t){const i=t.find((t=>e.startsWith(t)));return i?function(e,t){const i=[],n=e.split(r.sep);for(;n.length;){const e=n.join(r.sep);if(e&&(i.push(e),e===t))break;n.pop()}return i}(e,i):[e]}class li{constructor(){this.emitter=new v,this.messages=[],this.decorations={},this.subscriptions=new k,this.subscriptions.add(this.emitter),this.subscriptions.add(atom.config.observe("linter-ui-default.decorateOnTreeView",(e=>{if(void 0===this.decorateOnTreeView)this.decorateOnTreeView=e;else if("None"===e)this.update([]),this.decorateOnTreeView=e;else{const t=this.messages;this.decorateOnTreeView=e,this.update(t)}}))),setTimeout((()=>{const e=li.getElement();e&&this.subscriptions.add(ht(e,"click",Fe((()=>{this.update()})),{passive:!0}))}),100)}update(e=null){Array.isArray(e)&&(this.messages=e);const t=this.messages,i=li.getElement(),n=this.decorateOnTreeView;i&&"None"!==n&&this.applyDecorations(function(e,t){const i={},n=atom.project.getPaths();return t.forEach((function(t){const s=C(t);s&&("Files"===e?[s]:ai(s,n)).forEach((e=>function(e,t,i){e[t]||(e[t]={info:!1,error:!1,warning:!1}),e[t][i]=!0}(i,e,t.severity)))})),i}(n,t))}applyDecorations(e){const t=li.getElement();if(!t)return;const i={},n={};Object.keys(this.decorations).forEach((n=>{if({}.hasOwnProperty.call(this.decorations,n)&&!e[n]){const e=i[n]||(i[n]=li.getElementByPath(t,n));e&&this.removeDecoration(e)}})),Object.keys(e).forEach((s=>{if(!{}.hasOwnProperty.call(e,s))return;const r=i[s]||(i[s]=li.getElementByPath(t,s));r&&(this.handleDecoration(r,!!this.decorations[s],e[s]),n[s]=e[s])})),this.decorations=n}handleDecoration(e,t=!1,i){let n;t&&(n=e.querySelector("linter-decoration")),n?n.className="":(n=document.createElement("linter-decoration"),e.appendChild(n)),i.error?n.classList.add("linter-error"):i.warning?n.classList.add("linter-warning"):i.info&&n.classList.add("linter-info")}removeDecoration(e){const t=e.querySelector("linter-decoration");t&&t.remove()}dispose(){this.subscriptions.dispose()}static getElement(){return document.querySelector(".tree-view")}static getElementByPath(e,t){return e.querySelector(`[data-path=${CSS.escape(t)}]`)}}class ci{constructor(){this.name="Linter",this.signal=new le,this.commands=new se,this.messages=[],this.statusBar=new ae,this.intentions=new ce,this.subscriptions=new k,this.idleCallbacks=new Set,this.subscriptions.add(this.signal),this.subscriptions.add(this.commands),this.subscriptions.add(this.statusBar);const e=window.requestIdleCallback((()=>{this.idleCallbacks.delete(e),this.panel=new ne,this.panel.update(this.messages)}));this.idleCallbacks.add(e);const t=window.requestIdleCallback((()=>{this.idleCallbacks.delete(t),this.subscriptions.add(atom.config.observe("linter-ui-default.showDecorations",(e=>{e&&!this.editors?(this.editors=new oi,this.editors.update({added:this.messages,removed:[],messages:this.messages})):!e&&this.editors&&(this.editors.dispose(),this.editors=null)})))}));this.idleCallbacks.add(t)}render(e){const t=this.editors;this.messages=e.messages,t&&(t.isFirstRender()?t.update({added:e.messages,removed:[],messages:e.messages}):t.update(e)),this.treeview||(this.treeview=new li,this.subscriptions.add(this.treeview)),this.treeview.update(e.messages),this.panel&&this.panel.update(e.messages),this.commands.update(e.messages),this.intentions.update(e.messages),this.statusBar.update(e.messages)}didBeginLinting(e,t){this.signal.didBeginLinting(e,t)}didFinishLinting(e,t){this.signal.didFinishLinting(e,t)}dispose(){this.idleCallbacks.forEach((e=>window.cancelIdleCallback(e))),this.idleCallbacks.clear(),this.subscriptions.dispose(),this.panel&&this.panel.dispose(),this.editors&&this.editors.dispose()}}const ui=new Set,hi=new Set;let di,pi;exports.activate=function(){atom.config.get("linter-ui-default.useBusySignal")&&atom.packages.getLoadedPackage("linter-ui-default").metadata["package-deps"].push("busy-signal");const e=window.requestIdleCallback((function(){ui.delete(e),atom.inSpecMode()||s("linter-ui-default")}));ui.add(e)},exports.deactivate=function(){ui.forEach((e=>window.cancelIdleCallback(e))),ui.clear();for(const e of hi)e.dispose();hi.clear()},exports.provideUI=function(){const e=new ci;return hi.add(e),di&&e.signal.attach(di),e},exports.provideIntentions=function(){return Array.from(hi).map((e=>e.intentions))},exports.consumeSignal=function(e){di=e,hi.forEach((function(e){e.signal.attach(di)}))},exports.consumeStatusBar=function(e){pi=e,hi.forEach((function(e){e.statusBar.attach(pi)}))};
//# sourceMappingURL=index.js.map
